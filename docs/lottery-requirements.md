# 抽獎系統需求草案

## 目標與場景
- 公司活動進行多場抽獎，支援現場大螢幕展示、流暢動畫與主持人可控。
- 單一應用同時滿足觀眾顯示與人資操作者控台，適合離線或弱網環境。
- 行動裝置可輔助查看結果或遠端控制；投影／LED 大螢幕需最佳呈現。

## 角色與權限
- 人資／主持操作者：匯入與清洗名單與獎項、設定規則、開始／暫停／重抽／覆核指定得主、維護視覺與場次、匯出報表。
- 觀眾：觀看抽獎動畫與結果；可透過大螢幕或手機查看最新中獎名單。
- 無嚴格前台／後台分離：同一套應用提供「觀眾顯示模式」與「操作者模式」，需有權限控管與防誤觸切換。

## 資料模型（草案）
- 參與者：id、姓名、部門、員編／email、權重、資格標記（可抽／排除）、出席狀態。
- 獎項：id、名稱、價值、數量、組別（如頭獎／貳獎）、抽取順序、是否允許重複得獎。
- 抽獎場次：id、名稱、預定時間、對應獎項批次、抽取人數、抽取規則、是否公開動畫。
- 中獎紀錄：場次 id、獎項 id、參與者 id、抽取時間、操作者、狀態（確認／撤銷／重抽）、備註。
- 場景設定：背景圖／影片、主色、LOGO、標語／跑馬燈、動畫風格配置。

## 觀眾端需求
- 抽獎視覺：全螢幕模式、品牌色／背景自訂、Logo／標題展示。
- 抽獎動畫：滾動名單／翻牌／輪盤等至少一種；支援倒數開啟、暫停、重播。
- 中獎名單動畫：揭曉時可一次顯示多人；支援分批顯示、彈跳／漸入等效果；清晰顯示獎項名稱。
- 響應式：大螢幕／投影最佳化；手機可查看結果（若需要）。
- 實況資訊：可顯示目前場次名稱、剩餘獎數、已抽人數、訊息跑馬燈。
- 無干擾模式：抽獎時避免彈窗；結果揭曉後可手動或計時回到待機畫面。

## 人資／操作者需求
- 名單匯入／新增：CSV/Excel 模板、欄位驗證（必填、重複、Email 格式）、去重；支援單筆新增與批次更新。
- 獎項匯入／新增：數量、組別、抽取順序、圖示；支援批次調整剩餘數量。
- 抽獎規則：限制每人僅得獎一次或允許重複；依部門／職級配額；權重或黑名單；出席簽到後才具資格。
- 指定中獎：可預先鎖定得主或於抽出後覆核並改寫；必須留痕（操作者、時間、原因）。
- 操作控制：建立多個場次／批次；開始、暫停、重抽；撤銷單筆或整批並重跑；試抽模式與正式模式分離。
- 匯出報表：中獎名單 CSV/Excel，含場次、獎項、時間、操作者；可匯出操作記錄供稽核。
- 視覺設定：主色、背景（圖／影片／色）、標語、LOGO、動畫風格、文字大小；可一鍵切換觀眾模式。
- 權限與稽核：帳號角色、登入驗證、操作日誌（匯入／抽獎／撤銷／指定）、IP/裝置記錄。
- 系統健康：簡易儀表板顯示剩餘獎項、場次排程、最近錯誤；離線模式同步提醒。

## 抽獎流程（建議）
1) 準備：匯入參與者與獎項、設定抽獎場次與規則、決定場景、試抽驗證。
2) 現場：選擇場次 → 倒數 → 抽獎動畫 → 揭曉 → 確認／標註中獎 → 自動更新剩餘獎項。
3) 例外：若中獎者不符資格→撤銷並重抽；需要指定得主→改寫後紀錄原因。
4) 結束：匯出報表、鎖定資料、產出簡報或投影片格式的結果。

## 非功能需求
- 效能：名單至少 10k 人、獎項數百筆仍能即時動畫；抽取延遲 < 1s；動畫幀率穩定。
- 可用：抽獎過程可離線運作（需預先同步資料）；操作錯誤可撤銷；支援備份與還原。
- 安全：憑證登入（SSO/OAuth 或內建帳密）、RBAC；敏感資訊（員編／Email）儲存加密，備份需受控；匯出可選遮蔽欄位。
- 可觀測：操作／錯誤／審計日誌；匯入驗證報告；抽獎種子與版本紀錄以利重現。
- 可維運：部署版號、環境變數範本、排程備份；多語系支援（至少中英）。

## 已確認需求
- 得獎規則：獎項可設定是否允許重複得獎；可規範部門／職級配額與黑名單。
- 名單來源：不整合出勤／報到系統，全由手動新增或匯入。
- 模式區隔：單一應用提供觀眾顯示與操作者控台，可離線模式下同步兩端。
- 視覺設定：操作者可調品牌色、LOGO、背景（含影片）等場景。
- 公平性：需可重播並提供隨機種子與日誌以佐證公平。
- 串接方式：目前不需對外 API；啟動時同機啟動顯示與操控模式。

## 額外功能決策
- 遠端控制：可規劃；行動裝置靜控開啟／暫停／重播／揭曉，避免碰觸主螢幕。
- 預演／試播模式：可規劃；使用獨立資料，驗證動畫、流程與匯出。
- 多語系：可規劃；觀眾／操作者至少中／英切換。
- 硬體整合：暫不規劃；不做燈光／音效觸發。
- 證檔與封存：暫不規劃；不做簽章 PDF/CSV 封存。
- 即時備援：可規劃；匯出／匯入當前狀態（名單、剩餘獎項、隨機種子）以便換機復原。

## 其他建議決策
- 雙人覆核：暫不規劃；重大操作雙人確認與紀錄不納入本版。
- 場次排程：可規劃；可預先排程場次並設定自動倒數、動畫播放順序，現場需可觸發。
- 觀眾端鏡像：可規劃；提供唯讀 QR Code 頁面顯示最新結果，避免干擾主螢幕。

## 部署與運行需求
- 安裝型態：需無網路即可運作，提供可執行檔安裝包；啟動時同機啟動顯示與操控模式。
- 安裝範疇：安裝包應可在任何機器快速安裝後即能抽獎；另提供免安裝可攜式版本（可從隨身碟執行）。
- 更新方式：離線環境建議提供可下載／複製的更新包，保留向下相容的資料匯入格式。
- 硬體假設：可在桌機或活動主機執行；需支援外接大螢幕／投影輸出。

## 技術方案評估：Electron
- 優點：單一安裝包可同時承載觀眾顯示與操作者介面；易於離線運作與內嵌字型／素材；跨平台（Win/macOS/Linux）方便活動現場快速部署；可鎖定 kiosk/全螢幕模式。
- 風險：安裝檔體積與記憶體占用較大；硬體較弱時大螢幕動畫幀率需驗證；離線更新需自行設計差分更新流程；需處理簽章及系統權限（如螢幕錄影或多螢幕偵測）。
- 初步建議：因需求強調離線、單機同啟用顯示與控台，Electron 符合安裝與部署場景；若未來需瀏覽器版／PWA，仍可保留前端框架以利平行輸出。

## 其他實務決策
- 排練流程：可規劃；提供「彩排清單」與「場次鎖定」模式，避免正式抽獎誤用測試資料。
- 備份手順：不另規劃；以先前的即時備援（匯出狀態）為主。
- 公平審核：暫不規劃額外措施；沿用已有的隨機種子與重播／日誌能力。
